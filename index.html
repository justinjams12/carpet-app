<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Choice Floors - Master Installer</title>
    <style>
        :root {
            --navy: #0f172a; --gold: #c5a059; --blueprint-bg: #1e293b;
            --glass: rgba(255, 255, 255, 0.9);
        }
        body { font-family: 'Inter', sans-serif; margin: 0; background: #f1f5f9; display: flex; justify-content: center; }
        .app-shell { width: 100%; max-width: 480px; padding: 20px; box-sizing: border-box; }

        /* Header & Results */
        .live-result {
            background: var(--navy); color: white; border-radius: 24px; padding: 25px;
            text-align: center; margin-bottom: 20px; box-shadow: 0 20px 30px rgba(0,0,0,0.15);
        }
        .total-amount { font-size: 2.8rem; font-weight: 800; color: var(--gold); margin: 5px 0; }

        /* Visual Blueprint */
        .blueprint-card {
            background: var(--blueprint-bg); border-radius: 24px; padding: 20px;
            margin-bottom: 20px; position: relative; border: 2px solid #334155;
        }
        #blueprint { width: 100%; height: 240px; }
        .seam-line { stroke: #ef4444; stroke-width: 2; stroke-dasharray: 5,5; }
        .seam-label { fill: #ef4444; font-size: 7px; font-weight: bold; }

        /* Form Styling */
        .card { 
            background: var(--glass); backdrop-filter: blur(10px);
            border-radius: 20px; padding: 20px; margin-bottom: 20px;
            border: 1px solid white; box-shadow: 0 10px 20px rgba(0,0,0,0.05);
        }
        .row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        label { font-size: 0.65rem; font-weight: 800; color: #64748b; text-transform: uppercase; margin-bottom: 5px; display: block; }
        input, select { 
            width: 100%; padding: 12px; border-radius: 10px; border: 1.5px solid #e2e8f0; 
            font-size: 1rem; box-sizing: border-box; background: white;
        }
        .btn-gold { 
            background: var(--gold); color: white; border: none; padding: 15px; 
            border-radius: 12px; width: 100%; font-weight: 800; cursor: pointer;
        }
    </style>
</head>
<body>

<div class="app-shell">
    <div style="text-align:center; padding:10px;"><img src="choice-floors-logo.png" style="height:45px;"></div>

    <div class="live-result">
        <div class="total-amount" id="displayTotal">$0.00</div>
        <div style="font-size: 0.8rem; opacity: 0.7;" id="displaySub">Blueprint Seam Locator Active</div>
    </div>

    <div class="blueprint-card">
        <div style="position:absolute; top:10px; left:15px; color:rgba(255,255,255,0.4); font-size:0.6rem; font-weight:900;">TECHNICAL SEAM PLAN</div>
        <svg id="blueprint" viewBox="0 0 200 200">
            <rect width="100%" height="100%" fill="rgba(255,255,255,0.03)" />
            <rect id="roomRect" x="50" y="50" width="0" height="0" fill="rgba(197, 160, 89, 0.15)" stroke="#c5a059" stroke-width="1.5" />
            <g id="seamGroup"></g> <text id="labelW" x="100" y="40" fill="#c5a059" font-size="8" text-anchor="middle" font-weight="bold"></text>
            <text id="labelL" x="40" y="100" fill="#c5a059" font-size="8" text-anchor="middle" font-weight="bold" transform="rotate(-90 40,100)"></text>
        </svg>
    </div>

    <div class="card">
        <div class="row">
            <div>
                <label>Roll Width</label>
                <select id="rollWidth" onchange="calculate()">
                    <option value="12">12' Roll (Standard)</option>
                    <option value="15">15' Roll (Wide)</option>
                </select>
            </div>
            <div><label>Customer Name</label><input type="text" id="custName" placeholder="Job Name"></div>
        </div>
        <div class="row">
            <div><label>Width (ft)</label><input type="number" id="wA" oninput="calculate()"></div>
            <div><label>Length (ft)</label><input type="number" id="lB" oninput="calculate()"></div>
        </div>
        <button class="btn-gold" onclick="saveToHistory()">Save Job & Blueprint</button>
    </div>
</div>

<script>
    function calculate() {
        let w = parseFloat(document.getElementById('wA').value) || 0;
        let l = parseFloat(document.getElementById('lB').value) || 0;
        let rollW = parseFloat(document.getElementById('rollWidth').value);
        
        // Visual Blueprint Logic
        let rect = document.getElementById('roomRect');
        let seamGroup = document.getElementById('seamGroup');
        seamGroup.innerHTML = ""; // Clear old seams

        let scale = 180 / Math.max(w, l, 1);
        let drawW = w * scale;
        let drawL = l * scale;
        let startX = (200 - drawW) / 2;
        let startY = (200 - drawL) / 2;

        rect.setAttribute('width', drawW);
        rect.setAttribute('height', drawL);
        rect.setAttribute('x', startX);
        rect.setAttribute('y', startY);

        document.getElementById('labelW').innerText = w > 0 ? w + "'" : "";
        document.getElementById('labelW').setAttribute('y', startY - 8);
        document.getElementById('labelL').innerText = l > 0 ? l + "'" : "";
        document.getElementById('labelL').setAttribute('y', startY + (drawL/2));
        document.getElementById('labelL').setAttribute('x', startX - 8);

        // Seam Locator Logic
        if (w > rollW) {
            let numSeams = Math.floor((w - 0.01) / rollW);
            for (let i = 1; i <= numSeams; i++) {
                let seamX = startX + (i * rollW * scale);
                let line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                line.setAttribute("x1", seamX);
                line.setAttribute("y1", startY);
                line.setAttribute("x2", seamX);
                line.setAttribute("y2", startY + drawL);
                line.setAttribute("class", "seam-line");
                seamGroup.appendChild(line);

                let text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                text.setAttribute("x", seamX + 2);
                text.setAttribute("y", startY + 10);
                text.setAttribute("class", "seam-label");
                text.textContent = `SEAM ${i}`;
                seamGroup.appendChild(text);
            }
        }

        // Price Logic
        let strips = Math.ceil((w + 0.25) / rollW);
        let totalSqYd = ((strips * rollW) * (l + 0.25)) / 9;
        let total = totalSqYd * 32.50;

        document.getElementById('displayTotal').innerText = `$${total.toLocaleString(undefined, {minimumFractionDigits: 2})}`;
        document.getElementById('displaySub').innerText = `${totalSqYd.toFixed(2)} Yds â€¢ ${strips} Fill Strips Needed`;
    }
</script>
</body>
</html>